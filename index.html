<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Robot Framework -testaus</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 0;
            background-color: #f7f7f7;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        header {
            background-color: #0066cc;
            color: white;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }
        h1, h2, h3 {
            color: #0066cc;
        }
        code {
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
            background-color: #f5f5f5;
            padding: 2px 4px;
            border-radius: 3px;
        }
        pre {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            border-left: 4px solid #0066cc;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
            text-align: left;
        }
        th {
            background-color: #0066cc;
            color: white;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .alert {
            background-color: #ffecb3;
            border-left: 4px solid #ffb300;
            padding: 15px;
            margin: 20px 0;
        }
        .section {
            margin-bottom: 30px;
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
        }
        a {
            color: #0066cc;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .result-section {
            margin-top: 40px;
        }
        .btn {
            display: inline-block;
            background-color: #0066cc;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            text-decoration: none;
            margin: 5px 0;
        }
        .btn:hover {
            background-color: #0055aa;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <header>
        <h1>Robot Framework -testaus</h1>
        <p>Automaatiotestaus dokumentaatio</p>
    </header>

    <div class="container">
        <div class="section">
            <h2>Yleiskatsaus</h2>
            <p>Tässä projektissa on toteutettu käyttöliittymän automaatiotestit Robot Frameworkin ja Browser-kirjaston avulla. Dokumentaatio sisältää ohjeet testien asentamiseen, käyttöönottoon ja suorittamiseen.</p>
        </div>

        <div class="section">
            <h2>Testien käyttöönotto</h2>

            <h3>Virtuaaliympäristön luonti ja aktivointi (Windows, esim. PowerShell tai Git Bash)</h3>
            <pre><code>python -m venv .venv
source .venv/Scripts/activate</code></pre>

            <h3>Riippuvuuksien asennus</h3>
            <pre><code>pip install -r testing/requirements.txt</code></pre>
        </div>

        <div class="section">
            <h2>Testitiedostojen sijainnit</h2>
            <ul>
                <li>Testit: <code>testing/tests/</code></li>
                <li>Resurssit: <code>testing/resources/</code></li>
                <li>Raportit ja julkaisu: <code>testing/results/</code></li>
            </ul>
        </div>

        <div class="section">
            <h2>Testattavat käyttötapaukset</h2>
            <table>
                <thead>
                    <tr>
                        <th>Käyttötapaus</th>
                        <th>Tunnus</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Rekisteröityminen</td>
                        <td>KI_3</td>
                    </tr>
                    <tr>
                        <td>Epäonnistunut kirjautuminen</td>
                        <td>KI_1</td>
                    </tr>
                    <tr>
                        <td>Onnistunut kirjautuminen</td>
                        <td>KI_1</td>
                    </tr>
                    <tr>
                        <td>Uuden kalenterimerkinnän lisääminen</td>
                        <td>DI_1</td>
                    </tr>
                    <tr>
                        <td>Kalenterimerkinnän muokkaus</td>
                        <td>DO_1</td>
                    </tr>
                    <tr>
                        <td>Kalenterimerkinnän poistaminen</td>
                        <td>DI_2</td>
                    </tr>
                    <tr>
                        <td>HRV-datan hakeminen Kubioksesta</td>
                        <td>KI_4</td>
                    </tr>
                    <tr>
                        <td>Uloskirjautuminen</td>
                        <td>KI_2</td>
                    </tr>
                    <tr>
                        <td>Chartin tarkastelu</td>
                        <td>DO_3</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <h2>Testien suorituskomennot</h2>
            <p>Tulokset tallentuvat kansioon <code>testing/results</code>. Jokainen komento ajetaan erikseen, ja tulokset (<code>log.html</code>, <code>report.html</code>) nimetään käsin halutulla tavalla testin mukaan.</p>

            <div class="alert">
                <strong>Huomio:</strong> Viimeisimpien testien tulokset löytyvät kansiosta <code>testing/results/latest</code>
            </div>

            <h3>Frontend-testit</h3>
            <pre><code>robot -d testing/results testing/tests/frontend/register_success.robot
robot -d testing/results testing/tests/frontend/login_fail.robot
robot -d testing/results testing/tests/frontend/login_success.robot
robot -d testing/results testing/tests/frontend/new_entry.robot
robot -d testing/results testing/tests/frontend/update_entry.robot
robot -d testing/results testing/tests/frontend/delete_entry.robot
robot -d testing/results testing/tests/frontend/get_HRV_data.robot
robot -d testing/results testing/tests/frontend/log_out.robot</code></pre>

            <h3>Backend-testit</h3>
            <pre><code>robot -d testing/results testing/tests/backend/login_invalid.robot
robot -d testing/results testing/tests/backend/login_validation.robot
robot -d testing/results testing/tests/backend/login_success.robot
robot -d testing/results testing/tests/backend/calendar_entries.robot
robot -d testing/results testing/tests/backend/calendar_month_vs_aamu.robot
robot -d testing/results testing/tests/backend/update_entry.robot
robot -d testing/results testing/tests/backend/delete_entry.robot</code></pre>

            <h3>Testin ajon jälkeen</h3>
            <p>Tee testin ajon jälkeen:</p>
            <ul>
                <li>Nimeä <code>log.html</code> ja <code>report.html</code> testin mukaan (esim. <code>log_login_success.html</code>).</li>
                <li>Siirrä ne oikeaan alikansioon projektin <code>results/</code>-rakenteessa, esimerkiksi <code>results/latest/reports</code> ja <code>results/latest/logs</code>.</li>
            </ul>
            <p>Näin varmistat, että tulokset säilyvät ja ovat selkeästi eroteltavissa.</p>
        </div>

        <div class="section result-section">
            <h2>Testitulokset</h2>

            <h3>Käyttäjätunnistautuminen frontend</h3>

            <h4>Rekisteröityminen</h4>
            <p>
                <a href="testing/results/old/reports/report_register_success.html" class="btn">Rekisteröityminen – raportti</a>
                <a href="testing/results/old/logs/log_register_success.html" class="btn">Rekisteröityminen – loki</a>
            </p>

            <h4>Kirjautuminen epäonnistuu</h4>
            <p>
                <a href="testing/results/old/reports/report_login_fail.html" class="btn">Kirjautuminen FAIL – raportti</a>
                <a href="testing/results/old/logs/log_login_fail.html" class="btn">Kirjautuminen FAIL – loki</a>
            </p>
            <p><img src="testing/results/old/screenshots/login_FAIL.png" alt="Epäonnistunut kirjautuminen" style="max-width:100%;"></p>

            <h4>Kirjautuminen onnistuu</h4>
            <p>
                <a href="testing/results/old/reports/report_login_success.html" class="btn">Kirjautuminen SUCCESS – raportti</a>
                <a href="testing/results/old/logs/log_login_success.html" class="btn">Kirjautuminen SUCCESS – loki</a>
            </p>
            <p><img src="testing/results/old/screenshots/login_SUCCESS.png" alt="Onnistunut kirjautuminen" style="max-width:100%;"></p>

            <h4>Uloskirjautuminen</h4>
            <p>
                <a href="testing/results/old/reports/report_logout.html" class="btn">Uloskirjautuminen – raportti</a>
                <a href="testing/results/old/logs/log_logout.html" class="btn">Uloskirjautuminen – loki</a>
            </p>

            <h3>Kalenterimerkinnät frontend</h3>

            <h4>Uuden merkinnän lisääminen</h4>
            <p>
                <a href="testing/results/old/reports/report_new_entry.html" class="btn">Uusi merkintä – raportti</a>
                <a href="testing/results/old/logs/log_new_entry.html" class="btn">Uusi merkintä – loki</a>
            </p>

            <h4>Merkinnän muokkaus</h4>
            <p>
                <a href="testing/results/old/reports/report_update_entry.html" class="btn">Muokattu merkintä – raportti</a>
                <a href="testing/results/old/logs/log_update_entry.html" class="btn">Muokattu merkintä – loki</a>
            </p>

            <h4>Merkinnän poistaminen</h4>
            <p>
                <a href="testing/results/old/reports/report_delete_entry.html" class="btn">Poistettu merkintä – raportti</a>
                <a href="testing/results/old/logs/log_delete_entry.html" class="btn">Poistettu merkintä – loki</a>
            </p>

            <h3>Terveystiedot HRV</h3>

            <h4>HRV-datan haku Kubioksesta</h4>
            <p>
                <a href="testing/results/old/reports/report_get_HRV_data.html" class="btn">HRV-datan haku – raportti</a>
                <a href="testing/results/old/logs/log_get_HRV_data.html" class="btn">HRV-datan haku – loki</a>
            </p>

            <h3>Taustapalvelun testaaminen</h3>

            <h4>API-virhekäsittelytesti</h4>
            <p>Testi tarkistaa, että /api/auth/login palauttaa 401 Unauthorized ja virheilmoituksen "Virheellinen käyttäjätunnus" väärillä tunnuksilla.</p>
            <p>
                <a href="testing/" class="btn">Virheellinen kirjautuminen - raportti</a>
                <a href="testing/results/old/logs/log_login_invalid.html" class="btn">Virheellinen kirjautuminen - loki</a>
            </p>

            <h4>Validointitesti</h4>
            <p>Testataan sitä, mitä tapahtuu kun syötetään puutteellista tai virheellisesti muotoiltua dataa, esimerkiksi puuttuva salasana tai liian lyhyt käyttäjänimi.</p>
            <p>
                <a href="testing/results/old/reports/report_login_validation.html" class="btn">Validonti: puuttuva salasanaa</a>
                <a href="testing/results/old/logs/log_login_validation.html" class="btn">Validointi: puuttuva salasana</a>
            </p>

            <h4>Onnistunut kirjautuminen – backend API</h4>
            <p>
                <a href="testing/results/old/reports/report_login_success_backend.html" class="btn">Kirjautuminen onnistuu – raportti</a>
                <a href="testing/results/old/logs/log_login_success_backend.html" class="btn">Kirjautuminen onnistuu – loki</a>
            </p>

            <h4>Kahden merkinnän lisääminen</h4>
            <p>
                <a href="testing/results/old/reports/report_calendar_entries.html" class="btn">Kahden merkinnän lisäys - raportti</a>
                <a href="testing/results/old/logs/log_calendar_entries.html" class="btn">Kahden merkinnän lisäys - loki</a>
            </p>

            <h4>Toukokuun vs_aamu arvojen hakeminen</h4>
            <p>
                <a href="testing/results/old/reports/report_calendar_vs_aamu.html" class="btn">Toukokuun vs_aamu arvot - raportti</a>
                <a href="testing/results/old/logs/log_calendar_vs_aamu.html" class="btn">Toukokuun vs_aamu arvot - loki</a>
            </p>
            <p><img src="testing/results/old/screenshots/vs_aamu_monthValues.png" alt="Toukokuun aamu arvojen haku" style="max-width:100%;"></p>

            <h4>Aiemman merkinnän muokkaaminen</h4>
            <p>
                <a href="testing/results/old/reports/report_update_entry_backend.html" class="btn">Muokattu merkintä - raportti</a>
                <a href="testing/results/old/logs/log_update_entry_backend.html" class="btn">Muokattu merkintä - loki</a>
            </p>

            <h4>Aiemman merkinnän poistaminen</h4>
            <p>
                <a href="testing/results/old/reports/report_delete_entry_backend.html" class="btn">Merkinnän poistaminen - raportti</a>
                <a href="testing/results/old/logs/log_delete_entry_backend.html" class="btn">Merkinnän poistaminen - loki</a>
            </p>
        </div>

        <div class="section">
            <h2>Testien suorittaminen yhdellä komennolla</h2>

            <p>Kaikkien testien ajaminen yhdellä komennolla ei ole tässä projektissa mahdollista ilman lisävalmistelua. Tähän vaikuttavat seuraavat syyt:</p>

            <table>
                <thead>
                    <tr>
                        <th>Testi</th>
                        <th>Miksi ongelmallinen?</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Rekisteröityminen</td>
                        <td>Samalla käyttäjätunnuksella voi rekisteröityä vain kerran → jos sama tunnus, toinen ajo FAIL.</td>
                    </tr>
                    <tr>
                        <td>Uuden kalenterimerkinnän lisääminen</td>
                        <td>Sama päivämäärä + käyttäjä voi saada Duplicate Key -virheen → FAIL.</td>
                    </tr>
                    <tr>
                        <td>Merkinnän muokkaaminen</td>
                        <td>Ok, toimii, jos merkintä on olemassa.</td>
                    </tr>
                    <tr>
                        <td>Merkinnän poistaminen</td>
                        <td>Poiston jälkeen sama testi ei enää löydä merkintää → FAIL.</td>
                    </tr>
                </tbody>
            </table>

            <div class="alert">
                <h4>Yhteenveto:</h4>
                <p>Monet testit ovat <strong>tilariippuvaisia</strong> (eli riippuvat siitä mitä tietokannassa jo on), jolloin "ajettavuus yhdellä komennolla" ei ole mahdollista ilman isompaa valmistelua (esim. automaattinen tietokannan resetointi ennen ajoa).</p>
                <p>Testit on rakennettu ajettaviksi <strong>yksittäin tai oikeassa järjestyksessä</strong>, mikä on tässä projektissa käytännönläheinen ratkaisu.</p>
            </div>

            <p>Kaikki testit voi periaatteessa ajaa komennolla:</p>
            <pre><code>robot --pythonpath . tests</code></pre>

            <p>Tai raportit <code>docs/</code>-kansioon:</p>
            <pre><code>robot --pythonpath . --outputdir docs tests</code></pre>

            <p>Mutta osa testeistä tosiaan epäonnistuisi, joten emme aio käyttää näitä komentoja testeissämme.</p>
        </div>

        <div class="section">
            <h2>Huomioita</h2>
            <ul>
                <li>HTML-raportit ja lokit ylikirjoitetaan jokaisen ajon yhteydessä.</li>
                <li>Jos haluaa säilyttää kaikki aiemmat testitulokset, kannattaa käyttää uniikkeja tiedostonimiä tai alikansioita.</li>
            </ul>
        </div>

        <footer style="text-align: center; margin-top: 50px; padding-top: 20px; border-top: 1px solid #eee; color: #777;">
            <p>Robot Framework -testausdokumentaatio &copy; 2025</p>
        </footer>
    </div>
</body>
</html>
